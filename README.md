# Сервис управления задачами

## Общая информация

Серверная чась сервиса разработана на основе фреймворка **FastAPI, СУБД PostgreSQL, миграции Alembic**

Клиентская часть сервиса разработана на

Основой взаимодействия с БД является паттерн ***UnitOfWork***, что позволяет абстрактно и гибко взаимодействовать с БД.

## Структура проекта

```
. # Предполагается, что у нас развернута целая система c разлчиными микросервисами
├── environments          # Переменные окружения сервисов/
│   └── tasks_manager/
│       └── .env.production
├── task_manager/ # Сервис для управления задачами
│   ├── app/
│   │   ├── api               # Папка хранения API всех роутеров и Зависимостей/
│   │   │   ├── routers.py
│   │   │   └── dependencies.py
│   │   ├── database          # Здесь лежит основной (общий) репозиторий по паттерну UnitOfWork
│   │   ├── migrations        # Миграции alembic
│   │   ├── modules           # Модули сервиса/
│   │   │   ├── reservation       # Модуль управления задачами/
│   │   │   │   ├── models            # Модели БД
│   │   │   │   ├── schemas           # Схемы pydantic
│   │   │   │   ├── router.py         # API-роутер модуля
│   │   │   │   ├── service.py        # Функции для взаимодействия с репозиторием для управления задачами
│   │   │   │   └── uow.py            # Репозиторий управления задач
│   │   │   └── # По такому же принципу можно вставлять любой модуль
│   │   ├── exceptions.py    # Исключения сервиса
│   │   ├── main.py          # Корень запуска проекта, содержащий middleware и включение всех роутеров
│   │   ├── settings.py      # Файл конфигурации сервиса и сервисов-соседей
│   │   ├── unitofwork.py    # Абстрактный класс к репозиториям для взаимодействия с БД
│   │   └── utils.py  
│   ├── .gitignore
│   └── startup.sh
├── frontend/ # Клиентская часть приложения
└── docker-compose.yaml   
```

## Требования:

* **Python 3.12**
* **Docker**
* **Docker-compose**
* **PostgreSQL**
* **Poetry**
* **NodeJS 20.18**

## Запуск сервиса

Клонирование сериса:

```
git clone https://github.com/YourCarma/tasks_manager.git
```

### Запуск сервиса вручную

#### Серверная часть

Переходим в папку проекта:

`cd tasks_manager`

Проверьте **переменные окружения** в `.env.production`!

**Убедитесь** в доступности **PostgreSQL**!

**Установка** зависимостей:

`poetry install`

**Активация** виртуального окружения:

`poetry shell`

**Миграции** БД:

`alembic upgrade head`

Далее **запускаем** сервис:

```
cd app
python main.py
```

**Сервис запущен!** Теперь можно посмотреть документацию **OpenAPI** `http://{HOST}:{PORT}/docs`

![1748684904768](image/README/1748684904768.png)

#### Клиентская часть

Переходим в папку клиентской части:

`cd frontend`

Проверьте **переменные окружения** в `.env.production`!

Установка зависимостей:

`npm i`

Запуск:

`npm run serve`

**Сервис запущен!** Клиентсая часть доступна по адресу `http://localhost:8080`

![1748685106914](image/README/1748685106914.png)

### Запуск сервиса с помощью docker-compose

`docker-compose.yaml` состоит из четырех контейнеров:

1. `task-manager-service` - сам сервис управления задачами
2. `postgres` - СУБД PostgreSQL
3. `portainer` - Portainer для графического взаимодействия
4. `frontend` - клиентская часть приложения

Запускаем сервисы:

`docker-compose up -d`

Выполняем миграции БД:

`docker-compose exec task-manager-service alembic upgrade head`

1. Заходим в [portainer](http://localhost:9000 "ссылка на portainer")
2. Создаем пользователя
3. Авторизируемся
4. Наблюдаем наши сервисы
5. **Готово!**

   ![1748688005365](image/README/1748688005365.png)
